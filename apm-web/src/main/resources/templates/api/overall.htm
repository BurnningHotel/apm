</br>

<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <i class="fa fa-th fa-fw"></i> Api Details

            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <table class="table table-striped table-bordered table-hover">
                    <tbody>
                    <tr>
                        <td><strong>ID</strong> : ${(api.id)!}</td>
                        <td>
                            <strong>Api Name</strong> : ${(api.name)!}
                        </td>
                        <td><strong>Description</strong> : ${(api.description)!}</td>

                    </tr>
                    <tr>
                        <td><strong>Path</strong> : ${(api.path)!}</td>
                        <td><strong>Project</strong> : ${(api.project.name)!}</td>

                        <td><strong>Status</strong> : ${(api.status)!""}</td>
                    </tr>
                    <tr>
                        <td><strong>Creator</strong> : ${(api.creator)!""}</td>
                        <td><strong>Create Time</strong>:${(api.createTime)!""}</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><strong>Last Modified User</strong> : ${(api.lastModifiedUser)!}</td>
                        <td><strong>Last Modified Date</strong> : ${(api.lastModifiedDate)!""}</td>
                        <td></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">

                <i class="fa fa-bar-chart-o fa-fw"></i> Run List
                <div class="pull-right">
                    <div class="btn-group">
                        <button type="button" class="btn btn-default btn-xs dropdown-toggle"
                                data-toggle="dropdown">
                            Actions
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu pull-right" role="menu">
                            <li><a href="/project/${api.project.id}/api/${api.id}/start">Start New Test</a>
                            </li>

                        </ul>
                    </div>
                </div>


            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <table class="table table-striped table-bordered table-hover" id="dataTables-runs">
                    <thead>
                    <tr>
                        <th>Id</th>
                        <th>Start Time</th>
                        <th>status</th>
                        <th>Duration</th>
                        <th>Hps</th>
                        <th>Apdex</th>
                        <th>AvgRT</th>
                        <th>TPS</th>
                        <th>Error Rate</th>
                        <th>Success Rate</th>
                        <th>CommitId</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>
                    <#list runs as run>
                    <tr>

                        <td>
                            <a href="/project/${projectId}/api/${api.id}/run/${run.id}/result">
                                ${(run.id)!}
                            </a>
                        </td>
                        <td>${(run.startTime)?date}</td>
                        <td>${(run.status)!}</td>
                        <td>${(run.duration)!0}</td>
                        <td>${(run.hps)!0}</td>
                        <td>${(run.apdex)!0}</td>
                        <td>${(run.avgRT)!0}</td>
                        <td>${(run.tps)!0}</td>
                        <td>${(run.error)!0}</td>
                        <td>${(run.success)!0}</td>
                        <td>${(run.commitId)!0}</td>
                        <td>
                            <a onclick="deleteRun($run.runId)" title="Delete Run Record">
                                <button type="button" class="btn btn-default btn-circle"><span
                                        class="glyphicon glyphicon-trash"></span></button>
                            </a>

                        </td>
                    </tr>
                    </#list>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                TPS Trend
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <div id="morris-area-chart"></div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                Avg RT Trend
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <div id="morris-bar-chart"></div>
            </div>
        </div>
    </div>
</div>


<script src="/bower_components/morrisjs/morris.min.js"></script>

<script>
        $(document).ready(function() {
            $('#dataTables-runs').DataTable({
                    responsive: true
            });
        });


        function deleteRun(id){
        if (confirm("Are you sure to delete this test record?")){
            var params={'runId': id };
            $.ajax({
                type: "POST",
                url: "$!{contextPath}/test/deleteRun",
                data: params,
                dateType: 'json',
            }).done(function(data){
                if(data.success){
                    alert("delete successful");
                    location.reload();
                 } else{
                     alert("failed");
                 }
            });
        }
    }

</script>


